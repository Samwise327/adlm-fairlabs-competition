"0","##To clean the R environment "
"0","rm(list=ls())"
"0",""
"0","d.in <- read.csv(""fairlabs_data.csv"")"
"0",""
"0","d.in <- d.in %>%"
"0","  clean_names()"
"0",""
"0","d.in[d.in == """"] <- NA"
"0",""
"0","un_enc <- length(unique(d.in$encounter_id))"
"0","un_mom <- length(unique(d.in$mother_id))"
"0",""
"0","d.in$maternal_race <- as.character(d.in$maternal_race)"
"0",""
"0","d.expl <- d.in %>%"
"0","  separate_rows(maternal_race, sep = ""\\s+"") %>%"
"0","  mutate(maternal_race = tolower(maternal_race)) %>%"
"0","  mutate(order_indication = ifelse(is.na(order_indication), ""no_indication"", order_indication))"
"0",""
"0","race_words <- as.data.frame(table(d.expl$maternal_race))"
"0",""
"0","d.expl_nodups <- d.expl[!duplicated(d.expl),]"
"0",""
"0","d.expl_race <- d.expl_nodups %>%"
"0","  mutate(values = 1) %>%"
"0","  pivot_wider(names_from = maternal_race, values_from = values, values_fill = 0)"
"0",""
"0","indications <- as.data.frame(table(d.expl_race$order_indication))"
"0",""
"0","d.expl_race_ind <- d.expl_race %>%"
"0","  mutate(values=1) %>%"
"0","  pivot_wider(names_from = order_indication, values_from = values, values_fill = 0)"
"0",""
"0","d.expl_race_ind <- d.expl_race_ind %>%"
"0","  mutate(uds_order_id = ifelse(!is.na(uds_order_id), 1, 0)) %>%"
"0","  mutate(cps_reporting_date = ifelse(!is.na(cps_reporting_date), 1, 0))"
"0",""
"0","d.moms <- as.data.frame(table(d.expl_race_ind$mother_id))"
"0","colnames(d.moms) <- c(""mother_id"", ""preg_cnt"")"
"0",""
"0","d.expl_race_ind_mom <- left_join(d.expl_race_ind, d.moms, by=""mother_id"")"
"0",""
"0","d.expl_race_ind_mom <- d.expl_race_ind_mom %>%"
"0","  mutate(delivery_date = month(delivery_date)) %>%"
"0","  rename(delivery_month = delivery_date)"
"0",""
"0","d.to_model <- d.expl_race_ind_mom %>%"
"0","  select(-encounter_id, -mother_id, -uds_collection_date, -uds_collection_date) %>%"
"0","  clean_names()"
"0",""
"0","d.to_model[is.na(d.to_model)] <- 0"
"0",""
"0","write.csv(d.to_model, ""to_model.csv"")"
